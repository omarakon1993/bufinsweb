@{
    ViewBag.Title = "Contacto - Bufins";
}

<!-- Contact Section -->
<section class="contact-section">
    <div class="container">
        <div class="row align-items-center min-vh-100">
            <div class="col-lg-10 mx-auto">
                <div class="text-center mb-5 contact-header" data-aos="fade-up">
                    <h1 class="contact-title mb-4">¿Empezamos?</h1>
                    <p class="contact-subtitle">Creemos en el impacto que genera desarrollar una cultura financiera en las organizaciones</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-6" data-aos="fade-right">
                        <div class="contact-form">
                            <h3 class="mb-4 text-purple">Contáctenos</h3>
                            <form id="contactForm">
                                @Html.AntiForgeryToken()
                                <div id="alertContainer"></div>
                                <div class="mb-3">
                                    <label for="nombre" class="form-label">Nombre completo</label>
                                    <input type="text" class="form-control" id="nombre" placeholder="Ingrese su nombre completo" required>
                                </div>
                                <div class="mb-3">
                                    <label for="empresa" class="form-label">Empresa</label>
                                    <input type="text" class="form-control" id="empresa" placeholder="Nombre de su empresa">
                                </div>
                                <div class="mb-3">
                                    <label for="email" class="form-label">Correo electrónico</label>
                                    <input type="email" class="form-control" id="email" placeholder="correo@ejemplo.com" required>
                                </div>
                                <div class="mb-3">
                                    <label for="telefono" class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="telefono" placeholder="+57 300 123 4567">
                                </div>
                                <div class="mb-3">
                                    <label for="mensaje" class="form-label">Mensaje</label>
                                    <textarea class="form-control" id="mensaje" rows="5" placeholder="Cuéntenos sobre su negocio y cómo podemos ayudarle..." required></textarea>
                                </div>
                                <button type="submit" class="btn btn-primary w-100">Enviar mensaje</button>
                            </form>
                        </div>
                    </div>

                    <div class="col-lg-6" data-aos="fade-left">
                        <div class="contact-form h-100 d-flex flex-column justify-content-between">
                            <div>
                                <h3 class="mb-4 text-purple">Información de contacto</h3>
                                <div class="mb-4">
                                    <div class="d-flex align-items-start mb-3">
                                        <div class="feature-icon me-3" style="font-size: 2rem;">
                                            <i class="fas fa-envelope"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Correo electrónico</h5>
                                            <p class="text-muted mb-0">admin@bufins.com</p>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start mb-3">
                                        <div class="feature-icon me-3" style="font-size: 2rem;">
                                            <i class="fas fa-phone"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Teléfono</h5>
                                            <p class="text-muted mb-0">+57 300 123 4567</p>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start mb-3">
                                        <div class="feature-icon me-3" style="font-size: 2rem;">
                                            <i class="fas fa-map-marker-alt"></i>
                                        </div>
                                        <div>
                                            <h5 class="mb-1">Ubicación</h5>
                                            <p class="text-muted mb-0">Colombia</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col-lg-12" data-aos="fade-up">
                        <div class="contact-form text-center">
                            <h4 class="mb-3 text-purple">Proceso de inicio</h4>
                            <p class="lead mb-4">Al contactarnos, seguiremos estos pasos para empezar:</p>
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <div class="p-3">
                                        <div class="text-cyan mb-2" style="font-size: 2.5rem; font-weight: 800;">01</div>
                                        <h6 class="text-purple">MEETUP</h6>
                                        <p class="small mb-0">Agendamos reunión para conocer su negocio</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="p-3">
                                        <div class="text-cyan mb-2" style="font-size: 2.5rem; font-weight: 800;">02</div>
                                        <h6 class="text-purple">PROPOSAL</h6>
                                        <p class="small mb-0">Presentamos propuesta y tiempos</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="p-3">
                                        <div class="text-cyan mb-2" style="font-size: 2.5rem; font-weight: 800;">03</div>
                                        <h6 class="text-purple">PLANNING</h6>
                                        <p class="small mb-0">Definimos variables de su modelo</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="p-3">
                                        <div class="text-cyan mb-2" style="font-size: 2.5rem; font-weight: 800;">04</div>
                                        <h6 class="text-purple">START</h6>
                                        <p class="small mb-0">Comenzamos a trabajar juntos</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section scripts {
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
    AOS.init({
        duration: 1000,
        once: true
    });

    // Form submission handler
    document.getElementById('contactForm').addEventListener('submit', function(e) {
        e.preventDefault();

        // Get alert container
        var alertContainer = document.getElementById('alertContainer');
        var submitButton = this.querySelector('button[type="submit"]');

        // Clear previous alerts
        alertContainer.innerHTML = '';

        // Disable submit button and show loading state
        submitButton.disabled = true;
        var originalText = submitButton.textContent;
        submitButton.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>Enviando...';

        // Get form values
        var formData = {
            Nombre: document.getElementById('nombre').value,
            Empresa: document.getElementById('empresa').value,
            Email: document.getElementById('email').value,
            Telefono: document.getElementById('telefono').value,
            Mensaje: document.getElementById('mensaje').value,
            __RequestVerificationToken: document.querySelector('input[name="__RequestVerificationToken"]').value
        };

        // Send AJAX request
        fetch('@Url.Action("Contact", "Home")', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams(formData)
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Show success message
                alertContainer.innerHTML =
                    '<div class="alert alert-success alert-dismissible fade show" role="alert">' +
                    '<i class="fas fa-check-circle me-2"></i>' + data.message +
                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>' +
                    '</div>';

                // Reset form
                document.getElementById('contactForm').reset();

                // Scroll to alert
                alertContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            } else {
                // Show error message
                var errorMessage = data.message;

                // Mostrar el error técnico detallado si existe
                if (data.error) {
                    errorMessage += '<br><br><strong>Detalle técnico:</strong><br><small>' + data.error + '</small>';
                }

                if (data.errors && data.errors.length > 0) {
                    errorMessage += '<ul class="mb-0 mt-2">';
                    data.errors.forEach(function(error) {
                        errorMessage += '<li>' + error + '</li>';
                    });
                    errorMessage += '</ul>';
                }

                alertContainer.innerHTML =
                    '<div class="alert alert-danger alert-dismissible fade show" role="alert">' +
                    '<i class="fas fa-exclamation-circle me-2"></i>' + errorMessage +
                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>' +
                    '</div>';

                // Scroll to alert
                alertContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        })
        .catch(error => {
            // Show error message
            alertContainer.innerHTML =
                '<div class="alert alert-danger alert-dismissible fade show" role="alert">' +
                '<i class="fas fa-exclamation-circle me-2"></i>' +
                'Ha ocurrido un error al enviar el mensaje. Por favor, inténtelo más tarde.' +
                '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>' +
                '</div>';

            // Scroll to alert
            alertContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        })
        .finally(() => {
            // Re-enable submit button
            submitButton.disabled = false;
            submitButton.textContent = originalText;
        });
    });
</script>
}
